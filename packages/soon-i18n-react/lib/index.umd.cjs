(function(o,a){typeof exports=="object"&&typeof module<"u"?a(exports,require("react"),require("soon-i18n-common")):typeof define=="function"&&define.amd?define(["exports","react","soon-i18n-common"],a):(o=typeof globalThis<"u"?globalThis:o||self,a(o["soon-i18n-react"]={},o.react,o["soon-i18n-common"]))})(this,function(o,a,r){"use strict";const j=(S,h={})=>{const p=S.fallbacks,k={},u={};r.loadSyncLocales(h,u);let l=S.lang??"",L=0;const i=[],K=()=>{L++,i.forEach(e=>{e(L)})},g=e=>{l=e,i.forEach(c=>{c(e)})},E=()=>l,_=()=>{const[e,c]=a.useState(l),[f,d]=a.useState(L);return a.useEffect(()=>{const t=s=>{typeof s=="number"?d(s):c(s)};return i.push(t),()=>{const s=i.findIndex(y=>y===t);i.splice(s,1)}},[]),[e,g,f]};return{useLocales:(e={})=>{const[c,f]=a.useState(()=>{const t={};return r.loadSyncLocales(e,t),t}),d=a.useRef({});return _(),(t,...s)=>{const y={};return[l,...p].reverse().forEach(n=>{Object.assign(y,u[n],c[n])}),t in y||[l,...p].some(n=>{if(!c[n])return r.loadLocale(b=>{f({...c,[n]:r.flatTreeKey(b)})},d,n,e),!0;if(!u[n])return r.loadLocale(b=>{u[n]=r.flatTreeKey(b),K()},k,n,h),!0}),r.formatObjKey(y,t,...s)}},useSoonI18n:_,tLocales:e=>{const c={};return r.loadSyncLocales(e,c),(f,...d)=>{const t={};return[l,...p].reverse().forEach(s=>{Object.assign(t,u[s],c[s])}),r.formatObjKey(t,f,...d)}},getLang:E,setLang:g}};o.createI18n=j,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})});
