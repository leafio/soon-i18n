(function(o,s){typeof exports=="object"&&typeof module<"u"?s(exports,require("react"),require("soon-i18n-common")):typeof define=="function"&&define.amd?define(["exports","react","soon-i18n-common"],s):(o=typeof globalThis<"u"?globalThis:o||self,s(o["soon-i18n-react"]={},o.react,o["soon-i18n-common"]))})(this,function(o,s,a){"use strict";const K=(b,h={})=>{const y=b.fallbacks??[],g={},f={};a.loadSyncLocales(h,f);let i=b.lang??"";const l=[],S=()=>{l.forEach(t=>{t()})},k=t=>{i=t,l.forEach(e=>{e(t),e()})},j=()=>i,x=()=>{const[t,e]=s.useState(i);return s.useEffect(()=>{const u=c=>{c&&e(c)};return l.push(u),()=>{const c=l.findIndex(r=>r===u);l.splice(c,1)}},[]),[t,k]},E=()=>{const[t,e]=s.useState(1);return s.useEffect(()=>{const u=c=>{c||e(r=>r+1)};return l.push(u),()=>{const c=l.findIndex(r=>r===u);l.splice(c,1)}},[]),[t,e]};return{useLocales:(t={})=>{const e=s.useRef(a.loadSyncLocales(t)),u=s.useRef({}),[c,r]=E();return s.useCallback((d,...O)=>{const p={};return[i,...y].reverse().forEach(n=>{Object.assign(p,f[n],e.current[n])}),(!e.current[i]||!(d in p))&&[i,...y].some(n=>{if(!e.current[n])return a.loadLocale(L=>{e.current[n]||(e.current={...e.current,[n]:a.flatTreeKey(L)},r(T=>T+1))},u.current,n,t),!0;if(!f[n])return a.loadLocale(L=>{f[n]=a.flatTreeKey(L),S()},g,n,h),!0}),a.formatObjKey(p,d,...O)},[c])},useLang:x,tLocales:t=>{const e={};return a.loadSyncLocales(t,e),(u,...c)=>{const r={};return[i,...y].reverse().forEach(d=>{Object.assign(r,f[d],e[d])}),a.formatObjKey(r,u,...c)}},getLang:j,setLang:k}};o.createI18n=K,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})});
